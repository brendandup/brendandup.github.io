<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>The Friends</title>
        <style>
            table {
                width: 100%;
            }
            table, th, td {
                border: 1px solid black;
                border-collapse: collapse;
            }
            input {
                border: none;
                width: 100%;
                box-sizing: border-box;
                -webkit-box-sizing:border-box;
                -moz-box-sizing: border-box;
                font-size: 14px;
            }
        </style>
    </head>
    <body>
        <script>
            var nbFriends = 73;
            var categories = ["ID", "Name", "Height" , "Width", "Gender", "Handedness", "Attack", "Defense", "Speed", "Health", "Magic", "Strength", "Intelligence", "Combo Damage", "Agility", "Eyesight"];
            var genderOptions = ["Male", "Female", "Other"];
            if (localStorage.getItem("items") === null) {
                var items = [];
                for (var row = 0; row < nbFriends; row++) {
                    items[row] = [];
                    for (var col = 0; col < categories.length; col++) {
                        items[row][col] = null;
                    }
                }
            } else {
                var items = JSON.parse(localStorage.getItem("items"));
            }
            
            var body = document.getElementsByTagName('body')[0];
            var tbl = document.createElement('table');
            
            var thd = document.createElement('thead');
            var tr = document.createElement('tr');
            for (var col = 0; col < categories.length; col++) {
                var th = document.createElement('th');
                th.appendChild(document.createTextNode(categories[col]));
                tr.appendChild(th);
            }
            thd.appendChild(tr);
            tbl.appendChild(thd);
            
            var tbdy = document.createElement('tbody');
            for (var row = 0; row < items.length; row++) {
                var tr = document.createElement('tr');
                for (var col = 0; col < items[0].length; col++) {
                    var td = document.createElement('td');
                    if (categories[col] === "ID") {
                        td.innerHTML = row  + 1;
                    } else {   
                        var input = document.createElement('input');
                        const i = row;
                        const j = col;
                        input.id = row * categories.length + col;
                        input.value = items[i][j];
                        input.readOnly = true;
                        input.onkeyup = function() {save(i, j)};
                        if (categories[j] === "Gender") {
                            var datalist = document.createElement('datalist');
                            datalist.id = "datalist";
                            input.appendChild(datalist);
                            ["Male", "Female", "Other"].forEach(function(data) {
                              var option = document.createElement('option')
                              option.value = data;
                              option.mouseup = function() {save(i, j)};
                              datalist.appendChild(option);
                            });
                            input.setAttribute('list', "datalist");
                        }
                        td.appendChild(input);
                    }
                    tr.appendChild(td);
                }
                tbdy.appendChild(tr);
            }
            tbl.appendChild(tbdy);
            body.appendChild(tbl);
        </script>
        
        <p><button onclick="edit()">Edit table</button></p>
        <p><button onclick="erase()">Erase table</button></p>
        
        <script>
            function edit() {
                var itemEls = document.getElementsByTagName("input");
                for (var i = 0; i < itemEls.length; i++) {
                    itemEls[i].readOnly = false;
                    if (itemEls[i].id % categories.length === categories.indexOf("Attack") || itemEls[i].id % categories.length === categories.indexOf("Defense") || itemEls[i].id % categories.length === categories.indexOf("Speed") || itemEls[i].id % categories.length === categories.indexOf("Health") || itemEls[i].id % categories.length === categories.indexOf("Magic") || itemEls[i].id % categories.length === categories.indexOf("Strength") || itemEls[i].id % categories.length === categories.indexOf("Intelligence") || itemEls[i].id % categories.length === categories.indexOf("Combo Damage") || itemEls[i].id % categories.length === categories.indexOf("Agility") || itemEls[i].id % categories.length === categories.indexOf("Eyesight")) {
                        itemEls[i].type = "number";
                        itemEls[i].min = 0;
                        itemEls[i].max = 100;
                    }
                    
                }
            }
            
            function save(row, col) {
                items[row][col] = document.getElementById(row * categories.length + col).value;
                localStorage.setItem("items", JSON.stringify(items));
                console.log(items);
            }
            
            function erase () {
                localStorage.clear();
            }
            
        </script>
    </body>
</html>
